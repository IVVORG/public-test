name: Cherry Pick Commits on Issue Creation

on:
  issues:
    types: [opened]

jobs:

  add-issue-comment:
    # Use GitHub Script to add a comment
    name: Build
    runs-on: ubuntu-latest
    steps:
      - name: Add comment to issue
        uses: actions/github-script@v6
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const issue_number = ${{ github.event.issue.id }};
            const workflow_run_url = `https://github.com/${context.repo.owner}/${context.repo.repo}/actions/runs/${context.runId}`;
            const body = `See workflow: [#${context.runNumber}](${workflow_run_url})`;
            await github.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number,
              body
            });

  cherry-pick:
    uses: ./.github/workflows/wf-sp.yml
    with: 
      org: 'IVVORG'
      repo: 'public-test-repo'
      team: 'DevOps_cp'
      user: '${{ github.event.issue.user.login }}'
      issue-title: '${{ github.event.issue.title }}'
      issue-body: '${{ github.event.issue.body }}'
    secrets:
      git_token: ${{ secrets.REPOREADING_TOKEN }}

